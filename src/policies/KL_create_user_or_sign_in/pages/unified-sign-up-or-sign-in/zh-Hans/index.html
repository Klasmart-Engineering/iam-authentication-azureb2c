<!DOCTYPE html>
<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <meta
            name="viewport"
            content="width=device-width, initial-scale=1, shrink-to-fit=no"
        />
        <link rel="preconnect" href="https://fonts.googleapis.com" />
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
        <link
            href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;500&amp;family=Source+Sans+Pro&amp;display=swap"
            rel="stylesheet"
        />
        <link
            href="../../../common/css/global.css"
            rel="stylesheet"
            data-preload="true"
            type="text/css"
        />
        <link
            href="../../../common/css/teacher.css"
            rel="stylesheet"
            data-preload="true"
            type="text/css"
        />
        <title>KidsLoop | Login</title>
    </head>

    <body>
        <div class="wrapper">
            <div class="main-content">
                <div class="header">
                    <img
                        class="logo"
                        src="../../../../../assets/logo.svg"
                    /><!-- Made visible after initial locale is set (to avoid seeing it flicker) -->
                    <div class="header__language-select" hidden>
                        <img
                            src="../../../../../assets/language-select-icon.svg"
                            alt="Language Select Icon"
                            class="language-select__icon"
                        /><select
                            id="language-select"
                            class="language-select"
                            title="Change Language"
                        >
                            <option value="en">English</option>
                            <option value="es">Español</option>
                            <option value="ko">한국어</option>
                            <option value="zh-Hans">汉语 (简体)</option>
                            <option value="vi">Tiếng Việt</option>
                            <option value="id">bahasa Indonesia</option>
                            <option value="th">ภาษาไทย</option>
                        </select>
                    </div>
                </div>
                <div class="main-content-wrapper">
                    <img
                        class="header-image"
                        src="../../../../../assets/cat_clouds_image.svg"
                        alt="Cat in clouds"
                    />
                    <h1 class="main-heading">Login</h1>
                    <div id="api"></div>

                    <div id="throbber" class="hidden centered">
                        <div class="lds-roller">
                            <div></div>
                            <div></div>
                            <div></div>
                            <div></div>
                            <div></div>
                            <div></div>
                            <div></div>
                            <div></div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="space-filler">
                <img
                    class="space-filler-image"
                    src="../../../../../assets/bada-teaching.svg"
                    alt="Badanamu teaching"
                />
            </div>
        </div>

        <script src="https://klukb2cstorage.blob.core.windows.net/b2ccosmosdb/policies/KL_create_user_or_sign_in/pages/unified-sign-up-or-sign-in/bundle.js"></script>

        <script>
            const signInNameField = document.getElementById("signInName")
            const redirectToSSOButton = document.getElementById(
                "SiginInWithKidsLoopCredentials"
            )
            const passwordLabel = document.querySelector(".password-label")
            const passwordInput = document.getElementById("password")
            const signInButton = document.getElementById("next")
            const createAccountLink = document.querySelector(".create")
            const elementsToRemoveForSSOAccounts = [
                passwordLabel,
                passwordInput,
                signInButton,
                createAccountLink,
            ]
            const throbberContainer = document.getElementById("throbber")

            function redirectToSSO() {
                const signInNameParts = signInNameField.value.split("@")

                if (
                    signInNameParts.length === 2 &&
                    signInNameParts[1].toLowerCase() === "kidsloop.live"
                ) {
                    throbberContainer.classList.remove("hidden")
                    redirectToSSOButton.click()
                    elementsToRemoveForSSOAccounts.forEach(function (element) {
                        element.remove()
                    })
                }
            }

            signInNameField.addEventListener("blur", redirectToSSO)
        </script>
    </body>
</html>
