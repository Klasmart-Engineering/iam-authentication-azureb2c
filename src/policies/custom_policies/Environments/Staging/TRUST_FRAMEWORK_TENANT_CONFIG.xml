<TrustFrameworkPolicy xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns="http://schemas.microsoft.com/online/cpim/schemas/2013/06" PolicySchemaVersion="0.3.0.0" TenantId="klkrstage.onmicrosoft.com" PolicyId="B2C_1A__TrustFrameworkTenantConfig" PublicPolicyUri="http://klkrstage.onmicrosoft.com/B2C_1A__TrustFrameworkTenantConfig">
  <BasePolicy>
    <TenantId>klkrstage.onmicrosoft.com</TenantId>
    <PolicyId>B2C_1A__TrustFrameworkExtensions</PolicyId>
  </BasePolicy>
  <BuildingBlocks>
    <DisplayControls>
      <DisplayControl Id="phoneVerificationControl" UserInterfaceControlType="VerificationControl">
        <InputClaims>
          <InputClaim ClaimTypeReferenceId="countryCode" DefaultValue="KR" />
        </InputClaims>
      </DisplayControl>
    </DisplayControls>
  </BuildingBlocks>
  <ClaimsProviders>
    <ClaimsProvider>
      <DisplayName>Local Account SignIn</DisplayName>
      <TechnicalProfiles>
        <TechnicalProfile Id="login-NonInteractive">
          <Metadata>
            <!-- ProxyIdentityExperienceFramework: Application ID -->
            <Item Key="client_id">b843f543-e81c-4da0-8e5e-cf41cd23d6f4</Item>
            <!-- IdentityExperienceFramework: Application ID-->
            <Item Key="IdTokenAudience">e54609f9-ed29-4a21-ad84-bb2073168778</Item>
          </Metadata>
          <InputClaims>
            <!-- ProxyIdentityExperienceFramework: Application ID -->
            <InputClaim ClaimTypeReferenceId="client_id" DefaultValue="b843f543-e81c-4da0-8e5e-cf41cd23d6f4" />
            <!-- IdentityExperienceFramework: Application ID-->
            <InputClaim ClaimTypeReferenceId="resource_id" PartnerClaimType="resource" DefaultValue="e54609f9-ed29-4a21-ad84-bb2073168778" />
          </InputClaims>
        </TechnicalProfile>
        <TechnicalProfile Id="SelfAsserted-LocalAccountSignin-PhoneNumber">
          <InputClaims>
            <!-- Set default countryCode on login with phone -->
            <InputClaim ClaimTypeReferenceId="countryCode" DefaultValue="KR" />
          </InputClaims>
        </TechnicalProfile>
      </TechnicalProfiles>
    </ClaimsProvider>
    <ClaimsProvider>
      <DisplayName>Azure Active Directory</DisplayName>
      <TechnicalProfiles>
        <TechnicalProfile Id="AAD-Common">
          <DisplayName>Azure Active Directory</DisplayName>
          <!-- Provide objectId and appId before using extension properties. -->
          <Metadata>
            <!-- B2C Extensions app: Object ID-->
            <Item Key="ApplicationObjectId">7ba89994-701c-4db6-9d5c-a2ad5fcf44c2</Item>
            <!-- B2C Extensions app: Application ID-->
            <Item Key="ClientId">29bd1e0a-4f88-4fe1-b7d0-198935f76a97</Item>
          </Metadata>
        </TechnicalProfile>
      </TechnicalProfiles>
    </ClaimsProvider>
    <ClaimsProvider>
      <DisplayName>Application Insights</DisplayName>
      <TechnicalProfiles>
        <TechnicalProfile Id="AzureInsights-Common">
          <DisplayName>Application Insights</DisplayName>
          <Protocol Name="Proprietary" Handler="Web.TPEngine.Providers.Insights.AzureApplicationInsightsProvider, Web.TPEngine, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null" />
          <Metadata>
            <!-- The ApplicationInsights instrumentation key which will be used for logging the events -->
            <Item Key="InstrumentationKey">7bacf10a-ea64-4a29-9e73-b7a7cc2c36a1</Item>
            <!-- A Boolean that indicates whether developer mode is enabled. This controls how events are buffered. In a development environment with minimal event volume, enabling developer mode results in events being sent immediately to ApplicationInsights. -->
            <Item Key="DeveloperMode">true</Item>
            <!-- A Boolean that indicates whether telemetry should be enabled or not. -->
            <Item Key="DisableTelemetry ">false</Item>
          </Metadata>
          <InputClaims>
            <!-- Properties of an event are added through the syntax {property:NAME}, where NAME is property being added to the event. DefaultValue can be either a static value or a value that's resolved by one of the supported DefaultClaimResolvers. -->
            <InputClaim ClaimTypeReferenceId="TenantId" PartnerClaimType="{property:TenantId}" DefaultValue="{Policy:RelyingPartyTenantId}" />
            <InputClaim ClaimTypeReferenceId="PolicyId" PartnerClaimType="{property:Policy}" DefaultValue="{Policy:PolicyId}" />
            <InputClaim ClaimTypeReferenceId="IP-Address" PartnerClaimType="{property:client_IP}" />
            <InputClaim ClaimTypeReferenceId="CorrelationId" PartnerClaimType="{property:CorrelationId}" />
            <InputClaim ClaimTypeReferenceId="Culture" PartnerClaimType="{property:Culture}" DefaultValue="{Culture:RFC5646}" />
            <InputClaim ClaimTypeReferenceId="objectId" PartnerClaimType="{property:ObjectId}" DefaultValue="Not available" />
          </InputClaims>
        </TechnicalProfile>
      </TechnicalProfiles>
    </ClaimsProvider>
    <ClaimsProvider>
      <DisplayName>Log in using KidsLoop</DisplayName>
      <TechnicalProfiles>
        <TechnicalProfile Id="Log-in-with-Kids-Loop">
          <Metadata>
            <Item Key="METADATA">https://login.microsoftonline.com/14a875d0-5038-4b90-8851-adf5acbeb8ea/v2.0/.well-known/openid-configuration</Item>
            <Item Key="client_id">0317151a-fbf6-4dd2-9354-97b73c1c9af8</Item>
          </Metadata>
          <CryptographicKeys>
            <Key Id="client_secret" StorageReferenceId="B2C_1A_KidsloopAppSecret" />
          </CryptographicKeys>
        </TechnicalProfile>
      </TechnicalProfiles>
    </ClaimsProvider>
  </ClaimsProviders>
</TrustFrameworkPolicy>
